{"mappings":"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","sources":["src/_utility.js","src/main/bok-data.js","src/main/main.js","src/main/bok.js"],"sourcesContent":["export const log = (...args) => {\n  console.log('CovOne Helper:', ...args)\n}\n\nexport const wait = async (ms) => {\n  await new Promise((resolve) => setTimeout(resolve, ms))\n}\n\nexport const setupElementTrigger = () => {\n  HTMLElement.prototype.trigger = function (eStr) {\n    var e = document.createEvent('HTMLEvents')\n    e.initEvent(eStr, true, true)\n    this.dispatchEvent(e)\n  }\n}\n\nexport const waitForElement = (selector, timeout = 2000, checkTimes = 10) => {\n  return new Promise((resolve, reject) => {\n    const duration = timeout / checkTimes\n    let times = 0\n\n    const checkElement = () => {\n      const element = document.querySelector(selector)\n      if (element) {\n        resolve(element)\n        return\n      }\n      if (++times >= checkTimes) {\n        reject('Element does not exist.')\n        return\n      }\n\n      setTimeout(checkElement, duration)\n    }\n    checkElement()\n  })\n}\n","const bokDataLoop = (data, newItemCreator) => {\n  data.page.map((page, pageIndex) => {\n    page.output.map((output, outputIndex) => {\n      const outputString = JSON.stringify(output)\n      const newItem = newItemCreator(output, outputIndex)\n      if (!newItem) return\n      console.log(pageIndex, outputIndex, outputString, JSON.stringify(newItem))\n      data.page[pageIndex].output[outputIndex] = newItem\n    })\n  })\n  return data\n}\n\nconst bokData = {\n  setNumberType(input, codes) {\n    // window.bokData.setNumberType(datadata, ['HER_SYS_ID', '県ナンバー', '市ナンバー', '年齢', '月齢', '喫煙開始年齢', '喫煙終了年齢', '喫煙一日本数', '妊娠週数', '妊娠月数', 'BMI', '身長', '体重', '高齢障害者身体手帳種', '高齢障害者身体手帳等級', '高齢障害者精神手帳等級', '接触者例目', '濃厚接触者年齢'])\n    const output = bokDataLoop(JSON.parse(input), (item, itemIndex) => {\n      if (!codes.find((value) => value === item.fieldCode)) return null\n      item.type = 'NUM'\n      return item\n    })\n    console.log(JSON.stringify(output))\n  },\n}\n\nexport default () => {\n  window.bokData = bokData\n}\n","import { log } from '../_utility'\nimport bok from './bok'\nimport bokData from './bok-data'\n\nlog('Main Version', process.env.now)\n\nbok()\nbokData()\n","import { log, wait, setupElementTrigger, waitForElement } from '../_utility'\n\nexport default () => {\n  const setup = (parent) => {\n    setupElementTrigger()\n\n    const div = document.createElement('div')\n    const h3 = document.createElement('h3')\n    h3.innerText = 'Bok Helper'\n\n    const button = document.createElement('button')\n    button.innerText = 'クリップボードからコマンドを反映'\n    button.setAttribute('id', 'apply-command')\n    button.addEventListener('click', async (event) => {\n      const value = await navigator.clipboard.readText()\n      if (!value) return\n\n      try {\n        const texts = value.split(':')\n        const attrs = texts[1].split(',')\n        const values = texts[0].split(',')\n\n        for (const [index, attr] of attrs.entries()) {\n          let value = values[index]\n          if (!value) continue\n          console.log(attr, value)\n\n          const targetInput = document.querySelector(\n            `.BoKpdf_prop_value_${attr}`,\n          )\n          console.log(targetInput)\n          if (targetInput) {\n            if (attr === 'fieldcode' && value === '現在日時') {\n              value = '&DATE'\n            }\n            if (\n              attr === 'fieldcode' &&\n              !targetInput.querySelector(`option[value=\"${value}\"]`)\n            ) {\n              continue\n            }\n\n            if (value.match(/^\\!.+/)) continue\n\n            targetInput.value = value\n\n            targetInput.focus()\n            if (targetInput.nodeName === 'SELECT') {\n              targetInput.trigger('change')\n            } else {\n              targetInput.trigger('change')\n              targetInput.trigger('keyup')\n            }\n          } else {\n            const targetRadio = document.querySelector(\n              `[name=BoKpdf_prop_value_${attr}][value=${value}]`,\n            )\n            if (!targetRadio) continue\n            targetRadio.checked = true\n            targetRadio.focus()\n            targetRadio.trigger('change')\n          }\n        }\n      } catch (e) {\n        alert('コマンドの実行に失敗しました\\n' + e.message)\n        return\n      }\n    })\n\n    const blockquote = document.createElement('blockquote')\n    blockquote.innerText = `\n複製: Ctrl + d\n削除: Ctrl + Backspace\nツールバー選択: Ctrl + 1-6\nコマンド適用: Ctrl + a\n`\n\n    div.appendChild(h3)\n    div.appendChild(button)\n    div.appendChild(blockquote)\n    parent.appendChild(div)\n\n    document.addEventListener('keydown', async (event) => {\n      // log(event)\n      if (event.ctrlKey && event.key === 'd') {\n        log('Shortcut', 'Dupulicate')\n        document\n          .querySelector('.reportpdf_report_config_dialog_itemCopy')\n          .trigger('click')\n        await wait(100)\n        document\n          .querySelector('.reportpdf_report_config_dialog_itemPaste')\n          .trigger('click')\n        return false\n      } else if (event.ctrlKey && event.key === 'Backspace') {\n        log('Shortcut', 'Delete')\n        document\n          .querySelector('.reportpdf_report_config_dialog_itemRemove')\n          .trigger('click')\n        return false\n      } else if (event.ctrlKey && event.key === 'a') {\n        log('Shortcut', 'Apply Command')\n        document.querySelector('#apply-command').trigger('click')\n        return false\n      } else if (event.ctrlKey && event.key.match(/[1-6]/)) {\n        log('Shortcut', 'Toolbox', event.key)\n        document\n          .querySelector(`.reportpdf_report_toolbox:nth-child(${event.key})`)\n          .trigger('click')\n        return false\n      }\n    })\n  }\n\n  const main = async () => {\n    try {\n      const bokLayoutButton = await waitForElement(\n        '#kintoneplugin-pattern-tbody > tr:nth-child(2) > td:nth-child(5) > div > div > div > button.template_setting',\n        3000,\n      )\n\n      bokLayoutButton.addEventListener(\n        'click',\n        async () => {\n          const parent = await waitForElement(\n            '#ui-id-1 > table > tbody > tr > td:nth-child(3) > table > tbody > tr:nth-child(2) > td',\n            2000,\n          )\n          setup(parent)\n        },\n        { once: true },\n      )\n      log('Bok installed')\n    } catch (e) {\n      log('Bok not installed', e)\n    }\n  }\n  main()\n}\n"],"names":["$487cd5f13853f1a3$export$bef1f36f5486a6a3","args","console","log","$487cd5f13853f1a3$export$f87fd54b9ab35b9e","HTMLElement","prototype","trigger","eStr","e","document","createEvent","initEvent","this","dispatchEvent","$487cd5f13853f1a3$export$1a1c301579a08d1e","selector","timeout","checkTimes","Promise","resolve","reject","duration","times","checkElement","element","querySelector","setTimeout","$0b812aea55331c77$var$bokData","setNumberType","input","codes","output","data","JSON","parse","newItemCreator","item","itemIndex","find","value","fieldCode","type","page","map","pageIndex","outputIndex","outputString","stringify","newItem","setup","parent","div","createElement","h3","innerText","button","setAttribute","addEventListener","async","event","navigator","clipboard","readText","texts","split","attrs","values","index","attr","entries","targetInput","match","focus","nodeName","targetRadio","checked","alert","message","blockquote","appendChild","ctrlKey","key","ms","$487cd5f13853f1a3$export$5c069c93d2b7493f","once","main","$9b98de22a5179085$export$2e2bcd8739ae039","window","bokData"],"version":3,"file":"main.js.map"}