{"version":3,"sources":["_utility.js","bok.js","main.js"],"names":["log","args","console","wait","Promise","resolve","setTimeout","ms","setupElementTrigger","HTMLElement","prototype","trigger","eStr","e","document","createEvent","initEvent","dispatchEvent","waitForElement","selector","timeout","checkTimes","reject","duration","times","checkElement","element","querySelector","addEventListener","parent","div","createElement","h3","innerText","button","setAttribute","value","navigator","clipboard","readText","texts","split","attrs","values","index","attr","entries","targetInput","match","focus","nodeName","targetRadio","checked","alert","message","blockquote","appendChild","event","ctrlKey","key","setup","once","main"],"mappings":"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","file":"main.js","sourceRoot":"../../helper/src/main","sourcesContent":["export const log = (...args) => {\n  console.log('CovOne Helper:', ...args)\n}\n\nexport const wait = async (ms) => {\n  await new Promise((resolve) => setTimeout(resolve, ms))\n}\n\nexport const setupElementTrigger = () => {\n  HTMLElement.prototype.trigger = function (eStr) {\n    var e = document.createEvent('HTMLEvents')\n    e.initEvent(eStr, true, true)\n    this.dispatchEvent(e)\n  }\n}\n\nexport const waitForElement = (selector, timeout = 2000, checkTimes = 10) => {\n  return new Promise((resolve, reject) => {\n    const duration = timeout / checkTimes\n    let times = 0\n\n    const checkElement = () => {\n      const element = document.querySelector(selector)\n      if (element) {\n        resolve(element)\n        return\n      }\n      if (++times >= checkTimes) {\n        reject('Element does not exist.')\n        return\n      }\n\n      setTimeout(checkElement, duration)\n    }\n    checkElement()\n  })\n}\n","import { log, wait, setupElementTrigger, waitForElement } from './_utility'\n\nexport default () => {\n  const setup = (parent) => {\n    setupElementTrigger()\n\n    const div = document.createElement('div')\n    const h3 = document.createElement('h3')\n    h3.innerText = 'Bok Helper'\n\n    const button = document.createElement('button')\n    button.innerText = 'クリップボードからコマンドを反映'\n    button.setAttribute('id', 'apply-command')\n    button.addEventListener('click', async (event) => {\n      const value = await navigator.clipboard.readText()\n      if (!value) return\n\n      try {\n        const texts = value.split(':')\n        const attrs = texts[1].split(',')\n        const values = texts[0].split(',')\n\n        for (const [index, attr] of attrs.entries()) {\n          const value = values[index]\n          if (!value) continue\n          console.log(attr, value)\n\n          const targetInput = document.querySelector(\n            `.BoKpdf_prop_value_${attr}`,\n          )\n          console.log(targetInput)\n          if (targetInput) {\n            if (\n              attr === 'fieldcode' &&\n              !targetInput.querySelector(`option[value=\"${value}\"]`)\n            ) {\n              continue\n            }\n\n            if (value.match(/^\\!.+/)) continue\n\n            targetInput.value = value\n\n            targetInput.focus()\n            if (targetInput.nodeName === 'SELECT') {\n              targetInput.trigger('change')\n            } else {\n              targetInput.trigger('change')\n              targetInput.trigger('keyup')\n            }\n          } else {\n            const targetRadio = document.querySelector(\n              `[name=BoKpdf_prop_value_${attr}][value=${value}]`,\n            )\n            if (!targetRadio) continue\n            targetRadio.checked = true\n            targetRadio.focus()\n            targetRadio.trigger('change')\n          }\n        }\n      } catch (e) {\n        alert('コマンドの実行に失敗しました\\n' + e.message)\n        return\n      }\n    })\n\n    const blockquote = document.createElement('blockquote')\n    blockquote.innerText = `\n複製: Ctrl + d\n削除: Ctrl + Backspace\nツールバー選択: Ctrl + 1-6\nコマンド適用: Ctrl + a\n`\n\n    div.appendChild(h3)\n    div.appendChild(button)\n    div.appendChild(blockquote)\n    parent.appendChild(div)\n\n    document.addEventListener('keydown', async (event) => {\n      // log(event)\n      if (event.ctrlKey && event.key === 'd') {\n        log('Shortcut', 'Dupulicate')\n        document\n          .querySelector('.reportpdf_report_config_dialog_itemCopy')\n          .trigger('click')\n        await wait(100)\n        document\n          .querySelector('.reportpdf_report_config_dialog_itemPaste')\n          .trigger('click')\n        return false\n      } else if (event.ctrlKey && event.key === 'Backspace') {\n        log('Shortcut', 'Delete')\n        document\n          .querySelector('.reportpdf_report_config_dialog_itemRemove')\n          .trigger('click')\n        return false\n      } else if (event.ctrlKey && event.key === 'a') {\n        log('Shortcut', 'Apply Command')\n        document.querySelector('#apply-command').trigger('click')\n        return false\n      } else if (event.ctrlKey && event.key.match(/[1-6]/)) {\n        log('Shortcut', 'Toolbox', event.key)\n        document\n          .querySelector(`.reportpdf_report_toolbox:nth-child(${event.key})`)\n          .trigger('click')\n        return false\n      }\n    })\n  }\n\n  const main = async () => {\n    try {\n      const bokLayoutButton = await waitForElement(\n        '#kintoneplugin-pattern-tbody > tr:nth-child(2) > td:nth-child(5) > div > div > div > button.template_setting',\n        3000,\n      )\n\n      bokLayoutButton.addEventListener(\n        'click',\n        async () => {\n          const parent = await waitForElement(\n            '#ui-id-1 > table > tbody > tr > td:nth-child(3) > table > tbody > tr:nth-child(2) > td',\n            2000,\n          )\n          setup(parent)\n        },\n        { once: true },\n      )\n      log('Bok installed')\n    } catch (e) {\n      log('Bok not installed', e)\n    }\n  }\n  main()\n}\n","import { log } from './_utility'\nimport bok from './bok'\n\nlog('Version', process.env.now)\n\nbok()\n"]}