{"mappings":"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","sources":["src/_utility.js","src/main/bok-data.js","src/main/app.js","src/main/main.js","src/main/bok.js"],"sourcesContent":["export const log = (...args) => {\n  console.log('CovOne Helper:', ...args)\n}\n\nexport const wait = async (ms) => {\n  await new Promise((resolve) => setTimeout(resolve, ms))\n}\n\nexport const setupElementTrigger = () => {\n  HTMLElement.prototype.trigger = function (eStr) {\n    var e = document.createEvent('HTMLEvents')\n    e.initEvent(eStr, true, true)\n    this.dispatchEvent(e)\n  }\n}\n\nexport const waitForElement = (selector, timeout = 2000, checkTimes = 10) => {\n  return new Promise((resolve, reject) => {\n    const duration = timeout / checkTimes\n    let times = 0\n\n    const checkElement = () => {\n      const element = document.querySelector(selector)\n      if (element) {\n        resolve(element)\n        return\n      }\n      if (++times >= checkTimes) {\n        reject('Element does not exist.')\n        return\n      }\n\n      setTimeout(checkElement, duration)\n    }\n    checkElement()\n  })\n}\n","const bokDataLoop = (data, newItemCreator) => {\n  data.page.map((page, pageIndex) => {\n    page.output.map((output, outputIndex) => {\n      const outputString = JSON.stringify(output)\n      const newItem = newItemCreator(output, outputIndex)\n      if (!newItem) return\n      console.log(pageIndex, outputIndex, outputString, JSON.stringify(newItem))\n      data.page[pageIndex].output[outputIndex] = newItem\n    })\n  })\n  return data\n}\n\nconst bokDataNum = (input, codes) => {\n  // window.bokData.setNumberType(datadata, ['HER_SYS_ID', '県ナンバー', '市ナンバー', '年齢', '月齢', '喫煙開始年齢', '喫煙終了年齢', '喫煙一日本数', '妊娠週数', '妊娠月数', 'BMI', '身長', '体重', '高齢障害者身体手帳種', '高齢障害者身体手帳等級', '高齢障害者精神手帳等級', '接触者例目', '濃厚接触者年齢'])\n  const output = bokDataLoop(JSON.parse(input), (item, itemIndex) => {\n    if (!codes.find((value) => value === item.fieldCode)) return null\n    item.type = 'NUM'\n    return item\n  })\n  console.log(JSON.stringify(output))\n}\n\nconst bokDataFontSize = (input, fontSize) => {\n  // window.bokData.setNumberType(datadata, ['HER_SYS_ID', '県ナンバー', '市ナンバー', '年齢', '月齢', '喫煙開始年齢', '喫煙終了年齢', '喫煙一日本数', '妊娠週数', '妊娠月数', 'BMI', '身長', '体重', '高齢障害者身体手帳種', '高齢障害者身体手帳等級', '高齢障害者精神手帳等級', '接触者例目', '濃厚接触者年齢'])\n  const output = bokDataLoop(JSON.parse(input), (item, itemIndex) => {\n    // if (!codes.find((value) => value === item.fieldCode)) return null\n    if (item.mode !== 'item_char') return\n    item.fontSize = fontSize\n    return item\n  })\n  console.log(JSON.stringify(output))\n}\n\nexport default () => {\n  window.bokData = {\n    bokDataNum,\n    bokDataFontSize,\n  }\n}\n","// window.app.getAppsId()\nconst getAppsId = async () => {\n  const {apps} = await kintone.api(kintone.api.url('/k/v1/apps', true), 'GET', {})\n  console.log(apps)\n\n  const filterApps = []\n  for(let i = 1; i <= 42; i++) {\n    const app = apps.find(app => !!app.name.match(new RegExp(`^CovOne_F${i}[^0-9].+$`)))\n    filterApps.push({\n      id: app ? app.appId : -1,\n      name: `F${i}`\n    })\n  }\n\n  console.log(filterApps)\n\n  let text = ''\n  filterApps.forEach(app => {text += `${app.id != -1 ? app.id : ''}\\t${app.name}\\n`})\n  console.log(text)\n\n  let envText = ''\n  filterApps.forEach(app => {\n    if (app.id != -1) envText += `${app.id},`\n  })\n  console.log(envText)\n}\n\nexport default () => {\n  window.app = {\n    getAppsId\n  }\n}","import { log } from '../_utility'\nimport bok from './bok'\nimport bokData from './bok-data'\nimport app from './app'\n\nlog('Main Version', process.env.now)\n\nbok()\nbokData()\napp()\n","import { log, wait, setupElementTrigger, waitForElement } from '../_utility'\n\nexport default () => {\n  const setup = (parent) => {\n    setupElementTrigger()\n\n    const div = document.createElement('div')\n    const h3 = document.createElement('h3')\n    h3.innerText = 'Bok Helper'\n\n    const button = document.createElement('button')\n    button.innerText = 'クリップボードからコマンドを反映'\n    button.setAttribute('id', 'apply-command')\n    button.addEventListener('click', async (event) => {\n      const value = await navigator.clipboard.readText()\n      if (!value) return\n\n      try {\n        const texts = value.split(':')\n        const attrs = texts[1].split(',')\n        const values = texts[0].split(',')\n\n        for (const [index, attr] of attrs.entries()) {\n          let value = values[index]\n          if (!value) continue\n          console.log(attr, value)\n\n          const targetInput = document.querySelector(\n            `.BoKpdf_prop_value_${attr}`,\n          )\n          console.log(targetInput)\n          if (targetInput) {\n            if (attr === 'fieldcode' && value === '現在日時') {\n              value = '&DATE'\n            }\n            if (\n              attr === 'fieldcode' &&\n              !targetInput.querySelector(`option[value=\"${value}\"]`)\n            ) {\n              continue\n            }\n\n            if (value.match(/^\\!.+/)) continue\n\n            targetInput.value = value\n\n            targetInput.focus()\n            if (targetInput.nodeName === 'SELECT') {\n              targetInput.trigger('change')\n            } else {\n              targetInput.trigger('change')\n              targetInput.trigger('keyup')\n            }\n          } else {\n            const targetRadio = document.querySelector(\n              `[name=BoKpdf_prop_value_${attr}][value=${value}]`,\n            )\n            if (!targetRadio) continue\n            targetRadio.checked = true\n            targetRadio.focus()\n            targetRadio.trigger('change')\n          }\n        }\n      } catch (e) {\n        alert('コマンドの実行に失敗しました\\n' + e.message)\n        return\n      }\n    })\n\n    const blockquote = document.createElement('blockquote')\n    blockquote.innerText = `\n複製: Ctrl + d\n削除: Ctrl + Backspace\nツールバー選択: Ctrl + 1-6\nコマンド適用: Ctrl + a\n`\n\n    div.appendChild(h3)\n    div.appendChild(button)\n    div.appendChild(blockquote)\n    parent.appendChild(div)\n\n    document.addEventListener('keydown', async (event) => {\n      // log(event)\n      if (event.ctrlKey && event.key === 'd') {\n        log('Shortcut', 'Dupulicate')\n        document\n          .querySelector('.reportpdf_report_config_dialog_itemCopy')\n          .trigger('click')\n        await wait(100)\n        document\n          .querySelector('.reportpdf_report_config_dialog_itemPaste')\n          .trigger('click')\n        return false\n      } else if (event.ctrlKey && event.key === 'Backspace') {\n        log('Shortcut', 'Delete')\n        document\n          .querySelector('.reportpdf_report_config_dialog_itemRemove')\n          .trigger('click')\n        return false\n      } else if (event.ctrlKey && event.key === 'a') {\n        log('Shortcut', 'Apply Command')\n        document.querySelector('#apply-command').trigger('click')\n        return false\n      } else if (event.ctrlKey && event.key.match(/[1-6]/)) {\n        log('Shortcut', 'Toolbox', event.key)\n        document\n          .querySelector(`.reportpdf_report_toolbox:nth-child(${event.key})`)\n          .trigger('click')\n        return false\n      }\n    })\n  }\n\n  const main = async () => {\n    try {\n      const bokLayoutButton = await waitForElement(\n        '#kintoneplugin-pattern-tbody > tr:nth-child(2) > td:nth-child(5) > div > div > div > button.template_setting',\n        3000,\n      )\n\n      bokLayoutButton.addEventListener(\n        'click',\n        async () => {\n          const parent = await waitForElement(\n            '#ui-id-1 > table > tbody > tr > td:nth-child(3) > table > tbody > tr:nth-child(2) > td',\n            2000,\n          )\n          setup(parent)\n        },\n        { once: true },\n      )\n      log('Bok installed')\n    } catch (e) {\n      log('Bok not installed', e)\n    }\n  }\n  main()\n}\n"],"names":["$487cd5f13853f1a3$export$bef1f36f5486a6a3","args","console","log","$487cd5f13853f1a3$export$f87fd54b9ab35b9e","HTMLElement","prototype","trigger","eStr","e","document","createEvent","initEvent","this","dispatchEvent","$487cd5f13853f1a3$export$1a1c301579a08d1e","selector","timeout","checkTimes","Promise","resolve","reject","duration","times","checkElement","element","querySelector","setTimeout","$0b812aea55331c77$var$bokDataLoop","data","newItemCreator","page","map","pageIndex","output","outputIndex","outputString","JSON","stringify","newItem","$0b812aea55331c77$var$bokDataNum","input","codes","parse","item","itemIndex","find","value","fieldCode","type","$0b812aea55331c77$var$bokDataFontSize","fontSize","mode","$53e37465e71309aa$var$getAppsId","async","apps","kintone","api","url","filterApps","i","app1","app","name","match","RegExp","push","id","appId","text","forEach","envText","setup","parent","div","createElement","h3","innerText","button","setAttribute","addEventListener","event","navigator","clipboard","readText","texts","split","attrs","values","index","attr","entries","targetInput","focus","nodeName","targetRadio","checked","alert","message","blockquote","appendChild","ctrlKey","key","ms","$487cd5f13853f1a3$export$5c069c93d2b7493f","once","main","$9b98de22a5179085$export$2e2bcd8739ae039","window","bokData"],"version":3,"file":"main.js.map"}