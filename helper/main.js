(()=>{const e=(...e)=>{console.log("CovOne Helper:",...e)},t=()=>{HTMLElement.prototype.trigger=function(e){var t=document.createEvent("HTMLEvents");t.initEvent(e,!0,!0),this.dispatchEvent(t)}},o=(e,t=2e3,o=10)=>new Promise(((n,c)=>{const i=t/o;let r=0;const l=()=>{const t=document.querySelector(e);t?n(t):++r>=o?c("Element does not exist."):setTimeout(l,i)};l()}));const n=(e,t)=>(e.page.map(((o,n)=>{o.output.map(((o,c)=>{const i=JSON.stringify(o),r=t(o,c);r&&(console.log(n,c,i,JSON.stringify(r)),e.page[n].output[c]=r)}))})),e),c=(e,t)=>{const o=n(JSON.parse(e),((e,o)=>t.find((t=>t===e.fieldCode))?(e.type="NUM",e):null));console.log(JSON.stringify(o))},i=(e,t)=>{const o=n(JSON.parse(e),((e,o)=>{if("item_char"===e.mode)return e.fontSize=t,e}));console.log(JSON.stringify(o))};const r=async()=>{const{apps:e}=await kintone.api(kintone.api.url("/k/v1/apps",!0),"GET",{});console.log(e);const t=[];for(let o=1;o<=42;o++){const n=e.find((e=>!!e.name.match(new RegExp(`^CovOne_F${o}[^0-9].+$`))));t.push({id:n?n.appId:-1,name:`F${o}`})}console.log(t);let o="";t.forEach((e=>{o+=`${-1!=e.id?e.id:""}\t${e.name}\n`})),console.log(o);let n="";t.forEach((e=>{-1!=e.id&&(n+=`${e.id},`)})),console.log(n)};e("Main Version","202202262133"),(()=>{const n=o=>{t();const n=document.createElement("div"),c=document.createElement("h3");c.innerText="Bok Helper";const i=document.createElement("button");i.innerText="クリップボードからコマンドを反映",i.setAttribute("id","apply-command"),i.addEventListener("click",(async e=>{const t=await navigator.clipboard.readText();if(t)try{const e=t.split(":"),o=e[1].split(","),n=e[0].split(",");for(const[e,t]of o.entries()){let o=n[e];if(!o)continue;console.log(t,o);const c=document.querySelector(`.BoKpdf_prop_value_${t}`);if(console.log(c),c){if("fieldcode"===t&&"現在日時"===o&&(o="&DATE"),"fieldcode"===t&&!c.querySelector(`option[value="${o}"]`))continue;if(o.match(/^\!.+/))continue;c.value=o,c.focus(),"SELECT"===c.nodeName?c.trigger("change"):(c.trigger("change"),c.trigger("keyup"))}else{const e=document.querySelector(`[name=BoKpdf_prop_value_${t}][value=${o}]`);if(!e)continue;e.checked=!0,e.focus(),e.trigger("change")}}}catch(e){return void alert("コマンドの実行に失敗しました\n"+e.message)}}));const r=document.createElement("blockquote");r.innerText="\n複製: Ctrl + d\n削除: Ctrl + Backspace\nツールバー選択: Ctrl + 1-6\nコマンド適用: Ctrl + a\n",n.appendChild(c),n.appendChild(i),n.appendChild(r),o.appendChild(n),document.addEventListener("keydown",(async t=>t.ctrlKey&&"d"===t.key?(e("Shortcut","Dupulicate"),document.querySelector(".reportpdf_report_config_dialog_itemCopy").trigger("click"),await(async e=>{await new Promise((t=>setTimeout(t,e)))})(100),document.querySelector(".reportpdf_report_config_dialog_itemPaste").trigger("click"),!1):t.ctrlKey&&"Backspace"===t.key?(e("Shortcut","Delete"),document.querySelector(".reportpdf_report_config_dialog_itemRemove").trigger("click"),!1):t.ctrlKey&&"a"===t.key?(e("Shortcut","Apply Command"),document.querySelector("#apply-command").trigger("click"),!1):t.ctrlKey&&t.key.match(/[1-6]/)?(e("Shortcut","Toolbox",t.key),document.querySelector(`.reportpdf_report_toolbox:nth-child(${t.key})`).trigger("click"),!1):void 0))};(async()=>{try{(await o("#kintoneplugin-pattern-tbody > tr:nth-child(2) > td:nth-child(5) > div > div > div > button.template_setting",3e3)).addEventListener("click",(async()=>{const e=await o("#ui-id-1 > table > tbody > tr > td:nth-child(3) > table > tbody > tr:nth-child(2) > td",2e3);n(e)}),{once:!0}),e("Bok installed")}catch(t){e("Bok not installed",t)}})()})(),window.bokData={bokDataNum:c,bokDataFontSize:i},window.app={getAppsId:r}})();
//# sourceMappingURL=main.js.map
