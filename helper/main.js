(()=>{const e=(...e)=>{console.log("CovOne Helper:",...e)},t=()=>{HTMLElement.prototype.trigger=function(e){var t=document.createEvent("HTMLEvents");t.initEvent(e,!0,!0),this.dispatchEvent(t)}},o=(e,t=2e3,o=10)=>new Promise(((n,c)=>{const r=t/o;let i=0;const l=()=>{const t=document.querySelector(e);t?n(t):++i>=o?c("Element does not exist."):setTimeout(l,r)};l()}));const n={setNumberType(e,t){const o=(n=JSON.parse(e),c=(e,o)=>t.find((t=>t===e.fieldCode))?(e.type="NUM",e):null,n.page.map(((e,t)=>{e.output.map(((e,o)=>{const r=JSON.stringify(e),i=c(e,o);i&&(console.log(t,o,r,JSON.stringify(i)),n.page[t].output[o]=i)}))})),n);var n,c;console.log(JSON.stringify(o))}};e("Main Version","202202251040"),(()=>{const n=o=>{t();const n=document.createElement("div"),c=document.createElement("h3");c.innerText="Bok Helper";const r=document.createElement("button");r.innerText="クリップボードからコマンドを反映",r.setAttribute("id","apply-command"),r.addEventListener("click",(async e=>{const t=await navigator.clipboard.readText();if(t)try{const e=t.split(":"),o=e[1].split(","),n=e[0].split(",");for(const[e,t]of o.entries()){let o=n[e];if(!o)continue;console.log(t,o);const c=document.querySelector(`.BoKpdf_prop_value_${t}`);if(console.log(c),c){if("fieldcode"===t&&"現在日時"===o&&(o="&DATE"),"fieldcode"===t&&!c.querySelector(`option[value="${o}"]`))continue;if(o.match(/^\!.+/))continue;c.value=o,c.focus(),"SELECT"===c.nodeName?c.trigger("change"):(c.trigger("change"),c.trigger("keyup"))}else{const e=document.querySelector(`[name=BoKpdf_prop_value_${t}][value=${o}]`);if(!e)continue;e.checked=!0,e.focus(),e.trigger("change")}}}catch(e){return void alert("コマンドの実行に失敗しました\n"+e.message)}}));const i=document.createElement("blockquote");i.innerText="\n複製: Ctrl + d\n削除: Ctrl + Backspace\nツールバー選択: Ctrl + 1-6\nコマンド適用: Ctrl + a\n",n.appendChild(c),n.appendChild(r),n.appendChild(i),o.appendChild(n),document.addEventListener("keydown",(async t=>t.ctrlKey&&"d"===t.key?(e("Shortcut","Dupulicate"),document.querySelector(".reportpdf_report_config_dialog_itemCopy").trigger("click"),await(async e=>{await new Promise((t=>setTimeout(t,e)))})(100),document.querySelector(".reportpdf_report_config_dialog_itemPaste").trigger("click"),!1):t.ctrlKey&&"Backspace"===t.key?(e("Shortcut","Delete"),document.querySelector(".reportpdf_report_config_dialog_itemRemove").trigger("click"),!1):t.ctrlKey&&"a"===t.key?(e("Shortcut","Apply Command"),document.querySelector("#apply-command").trigger("click"),!1):t.ctrlKey&&t.key.match(/[1-6]/)?(e("Shortcut","Toolbox",t.key),document.querySelector(`.reportpdf_report_toolbox:nth-child(${t.key})`).trigger("click"),!1):void 0))};(async()=>{try{(await o("#kintoneplugin-pattern-tbody > tr:nth-child(2) > td:nth-child(5) > div > div > div > button.template_setting",3e3)).addEventListener("click",(async()=>{const e=await o("#ui-id-1 > table > tbody > tr > td:nth-child(3) > table > tbody > tr:nth-child(2) > td",2e3);n(e)}),{once:!0}),e("Bok installed")}catch(t){e("Bok not installed",t)}})()})(),window.bokData=n})();
//# sourceMappingURL=main.js.map
